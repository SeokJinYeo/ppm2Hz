![ppm2hz logo](https://github.com/SeokJinYeo/ppm2Hz/blob/main/ppm2Hz%20icon.png)
# : Fast and accurate Matlab based 'susceptibility-induced B0 inhomogeneity' calculation programs
ppm2Hz is based on generalized susceptibility voxel convolution (gSVC) method which is rapid and artifact-free[1].
For application in various cases, the method was extended to arbitrary orientations and spatially varying applied fields[2].
Additionally another static magnetic field perturbation calculation method, k-space-discretized (KD) is coded in Matlab (ppm2Hz_KD). If you want more details (theory, applications) regarding the method, see the references below.

# Usage examples
- [examples][elliplink] of ppm2Hz applied to an ellipsoid model

[elliplink]: https://github.com/SeokJinYeo/ppm2Hz/tree/main/Example "example"

# Versions
Required input parameters vary in different versions; users need to check them for each code.
- ppm2Hz : Conventional cases when direction of object's magnetization (n) and the direction of its magnetic field (l) coincide with the z-direction (n=l=z).
- nppm2Hz : When the two directions are the same (n=l, not necessarily in z).
- ppm2Hznl : When the two directions are arbitrary.
- ppm2Hznl2 : When the applied field is spatially varying (in magnitude and direction) and the direction of perturbation is arbitrary. We need each component of applied vector magnetic field (Bx,By,Bz). They need to have the same grid and voxel sizes as the input susceptibility model.

# Common input parameters
- chi : (3D array) source susceptibility model [ppm] 
- dr : (1x3 vector) voxel size [m]
- B0 : (scalar) strength of applied magnetic field [T]
- n : (1x3 unit vector) direction of applied magnetic field (or magnetization)
- l : (1x3 unit vector) direction of perturbation field 

# gSVC input parameters
- r : (1x3 vector) distance between the first points of source and target grids [m]
- t : (1x3 vector) target grid size
- **ex) b0 = ppm2Hznl(chi,dr,r,t,n,l,B0);**

# KD input parameters
- ff : (integer) fine-grain factor
- bf : (integer) zero-filling factor
- **ex) b0 = ppm2Hznl_KD(chi,dr,ff,bf,n,l,B0);**

# References
[1] Lee SK, Hwang SH, Barg JS, Yeo SJ. Rapid, theoretically artifact-free calculation of static magnetic field induced by voxelated susceptibility distribution in an arbitrary volume of interest. Magn Reson Med. 2018;80(5):2109-2121.
[2] Seok-Jin Yeo, So-Hee Lee, Seung-Kyun Lee. Rapid calculation of static magnetic field perturbation generated by magnetized objects in arbitrary orientations. Magn Reson Med.  (submitted)



